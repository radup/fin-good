{
  "permissions": {
    "allow": [
      "Bash(mkdir:*)",
      "Bash(python -m pytest tests/test_config_security.py::TestSecretKeyValidation::test_valid_secret_key_accepted -v)",
      "Bash(python -m pytest tests/test_config_security.py::TestSecretKeyValidation -v)",
      "Bash(python -m pytest tests/test_config_security.py::TestSecretKeyValidation::test_missing_secret_key_rejected -v)",
      "Bash(python -m pytest tests/test_auth_security.py::TestJWTSecurityWithNewConfig -v)",
      "Bash(python -m pytest tests/test_auth_security.py::TestTokenForgerySecurity -v)",
      "Bash(python -m pytest tests/test_config_security.py tests/test_auth_security.py -v)",
      "Bash(python:*)",
      "Bash(mv:*)",
      "Bash(SECRET_KEY=\"test-key-for-development-32chars-min\" python -m pytest tests/test_config_security.py -v)",
      "Bash(SECRET_KEY=\"test-key-for-development-32chars-minimum-length\" python -c \"\nimport sys\nsys.path.append(''.'')\nfrom app.core.config import Settings\nprint(''Testing SECRET_KEY validation...'')\ntry:\n    settings = Settings()\n    print(''‚úÖ Settings loaded successfully'')\n    print(f''SECRET_KEY length: {len(settings.SECRET_KEY)}'')\nexcept Exception as e:\n    print(f''‚ùå Error: {e}'')\n\")",
      "Bash(PYTHONPATH=. SECRET_KEY=test-key-with-sufficient-length-for-security DATABASE_URL=postgresql://user:pass@localhost:5432/testdb REDIS_URL=redis://user:pass@redis.example.com:6379 python -c \"\nimport sys\nsys.path.insert(0, ''.'')\nfrom app.core.config import Settings\nprint(''‚úÖ Valid configuration accepted'')\ntry:\n    settings = Settings()\n    print(f''‚úÖ Settings created successfully'')\n    print(f''‚úÖ Database: {settings.DATABASE_URL}'')\n    print(f''‚úÖ Redis: {settings.REDIS_URL}'')\nexcept Exception as e:\n    print(f''‚ùå Error: {e}'')\n\")",
      "Bash(PYTHONPATH=. python:*)",
      "Bash(alembic init:*)",
      "Bash(alembic revision:*)",
      "Bash(chmod:*)",
      "Bash(alembic check:*)",
      "Bash(rm:*)",
      "Bash(grep:*)",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python -c \"\nimport sys\nsys.path.append(''.'')\nfrom app.core.config import Settings\ntry:\n    settings = Settings()\n    print(''‚úÖ Backend configuration is valid'')\n    print(f''Database URL configured: {bool(settings.DATABASE_URL)}'')\n    print(f''Redis URL configured: {bool(settings.REDIS_URL)}'')\n    print(f''SECRET_KEY length: {len(settings.SECRET_KEY)}'')\n    print(f''COMPLIANCE_SECRET_KEY length: {len(settings.COMPLIANCE_SECRET_KEY)}'')\n    print(f''HTTPS enforcement: {settings.ENFORCE_HTTPS}'')\nexcept Exception as e:\n    print(f''‚ùå Configuration error: {e}'')\n\")",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python -m pytest tests/ -v --tb=short)",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python -m pytest tests/unit/core/ -v --tb=short)",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python ./test_cookie_auth.py)",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python ./test_security_headers_simple.py)",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python ./test_crit006_implementation.py)",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python -c \"\n# Test core security implementations without database\nimport sys\nsys.path.append(''.'')\n\ntry:\n    # Test 1: Configuration\n    from app.core.config import Settings\n    settings = Settings()\n    print(''‚úÖ Configuration validation passed'')\n    \n    # Test 2: Security Headers \n    from app.core.security_headers_middleware import SecurityHeadersMiddleware\n    middleware = SecurityHeadersMiddleware(app=None, enforce_https=True, enable_security_logging=False)\n    headers = middleware._get_security_headers(is_https=True)\n    print(f''‚úÖ Security headers generated: {len(headers)} headers'')\n    \n    # Test 3: Sort parameter validation\n    from app.core.financial_validators import validate_and_secure_sort_parameters\n    try:\n        field, order = validate_and_secure_sort_parameters(''date'', ''desc'', ''transaction'', ''123'')\n        print(f''‚úÖ Sort validation passed: {field}, {order}'')\n    except Exception as e:\n        print(f''‚ö†Ô∏è  Sort validation: {e}'')\n    \n    # Test 4: Error sanitization\n    from app.core.error_sanitizer import error_sanitizer\n    sanitized = error_sanitizer.sanitize_error_message(''database error with sensitive info'')\n    print(f''‚úÖ Error sanitization: {sanitized[:50]}...'')\n    \n    # Test 5: Cookie auth (without database)\n    from app.core.cookie_auth import create_access_token\n    token = create_access_token(data={''sub'': ''test@example.com''})\n    print(f''‚úÖ Token creation passed: {token[:20]}...'')\n    \n    print(''\\nüéâ All core security tests passed!'')\n    \nexcept Exception as e:\n    print(f''‚ùå Error: {e}'')\n    import traceback\n    traceback.print_exc()\n\")",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python -c \"\n# Test core components without database connection\nimport sys\nsys.path.append(''.'')\n\nprint(''üîê Testing Core Security Components (No Database Required)'')\nprint(''='' * 60)\n\n# Test 1: Basic configuration\ntry:\n    from app.core.config import Settings\n    settings = Settings()\n    print(''‚úÖ 1. Configuration validation passed'')\n    print(f''   - SECRET_KEY: {len(settings.SECRET_KEY)} chars'')\n    print(f''   - COMPLIANCE_SECRET_KEY: {len(settings.COMPLIANCE_SECRET_KEY)} chars'')\n    print(f''   - HTTPS enforcement: {settings.ENFORCE_HTTPS}'')\nexcept Exception as e:\n    print(f''‚ùå 1. Configuration failed: {e}'')\n\n# Test 2: Security Headers (no dependencies)\ntry:\n    import unittest.mock\n    with unittest.mock.patch(''app.core.security_headers_middleware.get_logger''):\n        from app.core.security_headers_middleware import SecurityHeadersMiddleware\n        middleware = SecurityHeadersMiddleware(app=None, enforce_https=True, enable_security_logging=False)\n        headers = middleware._get_security_headers(is_https=True)\n        print(f''‚úÖ 2. Security headers: {len(headers)} generated'')\n        print(f''   - CSP: {\"\"Content-Security-Policy\"\" in headers}'')\n        print(f''   - HSTS: {\"\"Strict-Transport-Security\"\" in headers}'')\n        print(f''   - Frame protection: {\"\"X-Frame-Options\"\" in headers}'')\nexcept Exception as e:\n    print(f''‚ùå 2. Security headers failed: {e}'')\n\n# Test 3: Sort validation (no database)\ntry:\n    from app.core.financial_validators import SortParameterValidator\n    validator = SortParameterValidator()\n    field, order = validator.validate_sort_parameters(''date'', ''desc'', ''transaction'')\n    print(f''‚úÖ 3. Sort validation: {field}, {order}'')\n    \n    # Test SQL injection prevention\n    try:\n        validator.validate_sort_parameters(''amount; DROP TABLE users'', ''desc'', ''transaction'')\n        print(''‚ùå 3. SQL injection not blocked!'')\n    except Exception:\n        print(''‚úÖ 3. SQL injection properly blocked'')\nexcept Exception as e:\n    print(f''‚ùå 3. Sort validation failed: {e}'')\n\n# Test 4: Error sanitization\ntry:\n    from app.core.error_sanitizer import ErrorSanitizer\n    sanitizer = ErrorSanitizer()\n    original = ''Database error: password123 failed for user admin''\n    sanitized = sanitizer.sanitize_error_message(original)\n    print(f''‚úÖ 4. Error sanitization working'')\n    print(f''   - Sanitized: {sanitized[:50]}...'')\nexcept Exception as e:\n    print(f''‚ùå 4. Error sanitization failed: {e}'')\n\n# Test 5: JWT creation (no database)\ntry:\n    import os\n    os.environ[''SECRET_KEY''] = ''test-secret-key-for-development-only-min-32-chars''\n    \n    from app.core.cookie_auth import create_access_token_standalone\n    token = create_access_token_standalone({''sub'': ''test@example.com''})\n    print(f''‚úÖ 5. JWT token creation: {token[:30]}...'')\nexcept Exception as e:\n    print(f''‚ùå 5. JWT token creation failed: {e}'')\n\nprint(''\\nüéâ Core security component testing completed!'')\n\")",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python test_server.py)",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" REDIS_URL=\"redis://secure:password@localhost:6379\" python test_server.py)",
      "mcp__playwright__browser_navigate",
      "mcp__playwright__browser_click",
      "mcp__playwright__browser_take_screenshot",
      "Bash(find:*)",
      "Bash(true)",
      "Bash(git init:*)",
      "Bash(git branch:*)",
      "Bash(git add:*)",
      "Bash(git reset:*)",
      "Bash(gh auth:*)",
      "Bash(./dev-status.sh)",
      "Bash(docker logs:*)",
      "Bash(docker restart:*)",
      "Bash(docker-compose:*)",
      "Bash(curl:*)",
      "Bash(docker ps:*)",
      "Bash(docker exec:*)",
      "Bash(alembic upgrade:*)",
      "Bash(./dev-setup.sh:*)",
      "Bash(source:*)",
      "Bash(pip install:*)",
      "Bash(DATABASE_URL=postgresql://postgres:development123@localhost:5432/fingood alembic upgrade head)",
      "Bash(DATABASE_URL=postgresql://postgres:development123@localhost:5432/fingood alembic revision --autogenerate -m \"initial_schema\")",
      "Bash(DATABASE_URL=postgresql://postgres:development123@localhost:5432/fingood python:*)",
      "Bash(npm run dev:*)",
      "Bash(docker stop:*)",
      "Bash(docker rm:*)",
      "Bash(./dev-start.sh:*)",
      "mcp__browser-tools__getConsoleErrors",
      "mcp__playwright__browser_console_messages",
      "mcp__sequential-thinking__sequentialthinking",
      "Bash(gh pr comment:*)",
      "Bash(gh pr merge:*)",
      "Bash(git push:*)",
      "Bash(gh pr view:*)",
      "Bash(gh pr:*)",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python -c \"\n# Test basic imports and configuration after merge\nimport sys\nsys.path.append(''.'')\ntry:\n    from app.core.config import Settings\n    from app.core.background_jobs import job_manager, JobPriority, JobState\n    from app.api.v1.endpoints.upload import router\n    \n    print(''‚úÖ All core imports successful after merge resolution'')\n    print(''‚úÖ Configuration loads correctly'')\n    print(''‚úÖ Background job system (RQ) imports correctly'')\n    print(''‚úÖ Upload router with RQ integration imports correctly'')\n    print()\n    print(''üéâ Merge resolution successful - all systems operational!'')\n    \nexcept Exception as e:\n    print(f''‚ùå Import error: {e}'')\n    import traceback\n    traceback.print_exc()\n\")",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python -c \"\n# Test basic imports and configuration after merge\nimport sys\nsys.path.append(''.'')\ntry:\n    from app.core.config import Settings\n    from app.core.background_jobs import job_manager, JobPriority, JobState\n    from app.api.v1.endpoints.upload import router\n    \n    print(''‚úÖ All core imports successful after merge resolution'')\n    print(''‚úÖ Configuration loads correctly'')\n    print(''‚úÖ Background job system (RQ) imports correctly'')\n    print(''‚úÖ Upload router with RQ integration imports correctly'')\n    print()\n    print(''üéâ Merge resolution successful - all systems operational!'')\n    \nexcept Exception as e:\n    print(f''‚ùå Import error: {e}'')\n    import traceback\n    traceback.print_exc()\n\")",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python -c \"\n# Test basic imports without Redis dependency\nimport sys\nsys.path.append(''.'')\ntry:\n    from app.core.config import Settings\n    from app.core.background_jobs import JobPriority, JobState, JobType, JobProgress\n    \n    print(''‚úÖ Configuration loads correctly'')\n    print(''‚úÖ Background job enums and classes import correctly'')\n    \n    # Test enum values\n    print(f''‚úÖ JobPriority values: {[p.value for p in JobPriority]}'')\n    print(f''‚úÖ JobState values: {[s.value for s in JobState]}'')\n    print(f''‚úÖ JobType values: {[t.value for t in JobType]}'')\n    \n    print()\n    print(''üéâ Core components import successfully after merge resolution!'')\n    \nexcept Exception as e:\n    print(f''‚ùå Import error: {e}'')\n    import traceback\n    traceback.print_exc()\n\")",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" python main.py)",
      "Bash(COMPLIANCE_SECRET_KEY=\"test-compliance-secret-key-at-least-32-chars-long\" REDIS_URL=\"redis://:secure_dev_password_2024@localhost:6379/0\" python main.py)",
      "Bash(pkill:*)"
    ],
    "deny": [],
    "ask": [],
    "additionalDirectories": [
      "/private/tmp"
    ]
  }
}